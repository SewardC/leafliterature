<!DOCTYPE html>	
<html>
<head>
	<link rel="shortcut icon" href="img/LeafLit_FavIcon.png" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" type="text/css" href="css/main.css"/>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery-migrate-1.0.0.js"></script>
	<!-- <script type="text/javascript" src="js/inlineDisqussions.js"></script> -->
	<!--<script type="text/javascript" src="js/turn.js"></script> -->
	<link rel="stylesheet" type="text/css" href="jquery.mobile.flip.css"/>
	<script type="text/javascript" src="js/jquery.mobile.flip.js"></script>
	<style>
			div{
				background-image: -webkit-linear-gradient(#EEE,#DDD);
  				}
		</style>
</head>
<body>
	<ul class = "TopBar">
		<li class = "TopBar_Content"><a href="HomePage.html">Home</a></li>
		<li class = "TopBar_Content"><a href="Profile_Page.html">Profile</a></li>
		<li class ="TopBar_Content"><a href="Contacts.html">Contact</a></li>
		<li class = "TopBar_Content"><a href="Settings.html">Settings</a></li>
	</ul>
	<div id="flipRoot" data-role="flip" data-flip-show-pager= "true" data-flip-forward-dir= "ltor" >
	</div>
	<script src="js/parse-1.2.12.min.js" type="text/javascript"></script>
	<script>
	var queryString = window.location.search;
	var parseQueryString = function( queryString ) {
	    var params = {}, queries, temp, i, l;
	 
	    // Split into key/value pairs
	    queries = queryString.split("&");
	 
	    // Convert the array of strings into an object
	    for ( i = 0, l = queries.length; i < l; i++ ) {
	        temp = queries[i].split('=');
	        params[temp[0]] = temp[1];
	    }
	 
	    return params;
	};
		$(document).ready(function(){
		var parseAPPID = "F5n5wBdrrgzuQznoRDr7Ac8dRhs2R68MPvlPiPki";
		var parseJSID = "3ARPcPd7ws047AUajiGiz85uvgFHLbxzv4feLCjo";
		Parse.initialize(parseAPPID, parseJSID);
		var essays = Parse.Object.extend("Essays");
		var query = new Parse.Query(essays);
		var params = parseQueryString(queryString);
		query.equalTo("objectId", params.article_id);
		query.find({
			success: function(results){
				for(var i =0; i < results.length; i++){
					var object = results[i];
					console.log(object.get('Title'));
					var numOfEssay = object.get('Essay').length;
					var essay = object.get('Essay');
					var start = 0;
					var numOfChar = 1190;
					var counter = 1;
					if(numOfEssay > 1190)
					{
						while(numOfEssay> 1190)
						{
							$('#flipRoot').append('<div class="p"><h1>' + object.get('Title')+ '</h1><span class="text">'+ essay.substr(start, numOfChar) + '</span></div>');
							//$('#magazine').append('<div><span class="text">Page 1</span></div>');
							numOfEssay -= 1190;
							start+=1190;
							counter++;
						}
						$('#filpRoot').append('<div class="p"><h1>' + object.get('Title')+ '</h1><span class="text">'+ essay.substr(start, essay.length-1) + '</span></div>');
					}
					else
					{
						$('#flipRoot').append('<div class="p"><h1>' + object.get('Title')+ '</h1><span class="text">'+ essay.substr(0, numOfEssay-1) + '</span></div>');
					}
					$("#flipRoot").flip({
						forwardDir: 'ltor' ,
					     height: '340px' ,
					     showpager: true ,
					     loop: true});
				}
			},
			error: function(error) {
				alert('Error');
			} 
		});
		
	});	
	
</script>
</body>
</html>